apiVersion: v1
kind: ConfigMap
metadata:
  name: redis-conf
data:
  redis.conf: |-
    port {{ .Values.port }}
    cluster-enabled yes
    cluster-config-file nodes.conf
    cluster-node-timeout 3000
    appendonly yes
    cluster-preferred-endpoint-type hostname
  runner.sh: |-
    #!/bin/bash
    redis-cli --cluster create redis-master-0:6379 redis-master-1:6379 redis-master-2:6379 redis-master-3:6379 redis-slave-0:6379 redis-slave-1:6379 redis-slave-2:6379 redis-slave-3:6379 --cluster-replicas 1